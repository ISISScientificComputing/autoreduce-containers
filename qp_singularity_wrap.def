Bootstrap: docker-daemon
From: autoreduction/qp:latest
Includecmd: no

%environment
    # Disabled a warning when importing Mantid
    export HDF5_DISABLE_VERSION_CHECK=1
    # Specifies Mantid-specific environment
    export PYTHONPATH=/opt/Mantid/scripts/:/opt/Mantid/scripts/Diffraction/:/opt/Mantid/bin:/opt/Mantid/lib:/opt/Mantid/plugins:/opt/Mantid/scripts/SANS/:/opt/Mantid/scripts/Inelastic/:/autoreduce
    # Specifies a custom location for the user properties
    export MANTIDPROPERTIES=/shared-config/Mantid.user.properties
    # Always activate the conda environment
    source /opt/miniconda/bin/activate && conda activate mantid

# This is used by "sinularity instance start"
%startscript
    python /autoreduce/queue_processors/queue_processor/queue_listener.py
